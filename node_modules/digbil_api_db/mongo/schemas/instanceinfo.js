/**
 * @author renaudsauvain
 * 
 * Module dependencies.
 */

/**
 * Exports schema
 */
module.exports.load = function(mg) {
	var Schema = mg.Schema;

	var up_time = (function() {
		var Up = new Schema({
			'start' : Date,
			'version' : String,
			'attp' : Number,
			'stop' : Date
		});
		return Up;
	})();

	var Info = new Schema({
		'cdate' : {
			type : Date,
			'default' : Date.now
		},
		'service' : {
			type : String
		},
		'host' : String,
		'privip' : String,
		'pubip' : String,
		'version' : String,
		'config' : String, // name-id of the configuration
		'last_ping' : Date,
		'up_time' : [ up_time ],
		'resources' : {
			topics : [ String ],
			queues : [ String ]
		},
		'ws_clients' : [ new Schema({
			'_id' : Schema.Types.ObjectId,
			'ts' : {
				type : Date,
				'default' : Date.now
			}
		}) ]
	});
	Info.set('versionKey', false);
	return Info;
};
