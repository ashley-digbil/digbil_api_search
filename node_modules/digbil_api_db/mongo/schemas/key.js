/**
 * Module dependencies.
 */

/**
 * Exports schema
 */
module.exports.load = function(mg) {
	var Schema = mg.Schema;

	var ops = new Schema({
		'ts' : {
			type : Date,
			'default' : Date.now
		},
		'comment' : {
			type : String,
			trim : true
		},
		"optype" : {
			type : Number,
		},
		"issuer" : {
			"service" : String, // fe-mcs
			"privip" : String,
			"pubip" : String,
			"host" : String,
			"user" : {
				type : Schema.Types.ObjectId
			}
		}
	});

	/* keys */
	var schema = new Schema({
		'ts' : {
			type : Date,
			'default' : Date.now
		},
		'expires' : Date,

		/* for certificates */
		'private' : {
			type : String,
            // accessors disabled. If we want to add encryption & decryption
            // we should put the existing `encrypt` and `decrypt` methods
            // in their own projects (digbil_utils). They are currently living
            // in the resources under LOCALS.modules.utils.common.cipher/decipher
			// set : mg.Digbil.encrypt,
			// get : mg.Digbil.decrypt
		},
		'public' : {
			type : String,
			// set : mg.Digbil.encrypt,
			// get : mg.Digbil.decrypt
		},

		'stat' : {
			type : Number,
			'default' : 0
		},
		'ops' : [ ops ]
	});
	return schema;
};
